DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);

DROP TABLE IF EXISTS lotofacil.lotofacil_resultado_num_1_frequencia;
CREATE TABLE lotofacil.lotofacil_resultado_num_1_frequencia (
  concurso_inicial NUMERIC NOT NULL,
  concurso_final   NUMERIC NOT NULL,
  cmp_num_1        NUMERIC NOT NULL,
  qt_vz            NUMERIC NOT NULL
);


/**
  Contabiliza quantas vezes um bola ainda n√£o saiu, saiu, repetindo, deixou de sair.
 */
DROP VIEW IF EXISTS lotofacil.v_lotofacil_resultado_num_1_frequencia;
CREATE VIEW lotofacil.v_lotofacil_resultado_num_1_frequencia
  AS
    SELECT
      num_1    AS cmp_num_1,
      count(*) AS qt_vz
    FROM lotofacil.lotofacil_resultado_num_frequencia
    GROUP BY num_1
    ORDER BY qt_vz DESC;

DROP FUNCTION IF EXISTS lotofacil.fn_lotofacil_resultado_num_1_frequencia( NUMERIC, NUMERIC );
CREATE FUNCTION lotofacil.fn_lotofacil_resultado_num_1_frequencia(concurso_inicial NUMERIC, concurso_final NUMERIC)
  RETURNS TABLE(cmp_num_1 NUMERIC, qt_vz NUMERIC)
LANGUAGE plpgsql
AS
$$
BEGIN
  RETURN QUERY SELECT
                 num_1,
                 count(*) :: NUMERIC AS qt_vz
               FROM lotofacil.lotofacil_resultado_num_frequencia
               WHERE concurso BETWEEN concurso_inicial AND concurso_final
               GROUP BY num_1
               ORDER BY qt_vz DESC;
END;
$$;

SELECT *
FROM lotofacil.fn_lotofacil_resultado_num_1_frequencia(1, 2000);


Select sm_df, count(*) as qt_vz from (
SELECT
  num_1 + num_2 + num_3 + num_4 + num_5 + num_6 + num_7 + num_8 +
  num_9 + num_10 + num_11 + num_12 + num_13 + num_14 + num_15 + num_16 + num_17 +
  num_18 + num_19 + num_20 + num_21 + num_22 + num_23 + num_24 + num_25 as sm_df
FROM lotofacil.lotofacil_resultado_num_frequencia) ltf_a
group by sm_df
order by qt_vz desc;
